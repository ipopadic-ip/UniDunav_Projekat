<div class="container mt-4">
  <button (click)="goBack()" class="btn btn-secondary mb-4">ğŸ”™ Nazad</button>
    <h2 class="text-center mb-4">{{ isEdit ? 'Izmeni verziju dokumenta' : 'Dodaj verziju dokumenta' }}</h2>

  <div class="mb-3">
    <label class="form-label">Izaberi dokument</label>
     <select class="form-control"
          [(ngModel)]="selectedDokumentId"
          name="dokumentId"
          [disabled]="isEdit"
          required>
    <option [value]="null" disabled>-- Izaberi --</option>
    <option *ngFor="let d of dokumenti" [value]="d.id">{{ d.naziv }}</option>
  </select>
  </div>

  <div class="mb-3">
    <label class="form-label">SadrÅ¾aj tekstualne verzije</label>

    <textarea class="form-control"
          [ngModel]="sadrzaj"
          (ngModelChange)="onContentChange($event)"
          name="sadrzaj" rows="4"></textarea>
    <!-- <textarea class="form-control" 
    [(ngModel)]="sadrzaj" 
    name="sadrzaj" rows="4"></textarea> -->
  </div>
  <!-- novi prikaz -->
  <div *ngIf="currentlyTyping.size > 0" class="text-muted mt-2">
    <ng-container *ngIf="currentlyTyping.size === 1">
      {{ currentlyTyping.values().next().value }} kuca...
    </ng-container>
    <ng-container *ngIf="currentlyTyping.size > 1">
      <span *ngFor="let email of currentlyTypingArray(); let last = last">
        {{ email }}<span *ngIf="!last">, </span>
      </span> kucaju...
    </ng-container>
  </div>
  <!-- <div *ngIf="nekoKuca" class="text-muted mt-2">Neko upravo kuca...</div> -->

  <div class="d-flex gap-3 flex-wrap mb-4">
  <button class="btn btn-success" (click)="sacuvajTekstualnuVerziju()">
    {{ isEdit ? 'ğŸ’¾ SaÄuvaj izmene' : 'â• Dodaj tekstualnu verziju' }}
  </button>

  <input type="file" (change)="onFileChange($event)" [disabled]="isEdit" />
  <button class="btn btn-primary" (click)="uploadVerzija()" [disabled]="isEdit">ğŸ“¤ Upload verzije</button>

  <button class="btn btn-secondary" (click)="otkazi()">OtkaÅ¾i</button>
  <button class="btn btn-warning ms-auto" (click)="prikaziUporedjivanje()">ğŸ“ Uporedi verzije</button>
</div>

 <div *ngIf="prikaziUporedi">
    <h3>Uporedi dve verzije dokumenta</h3>

    <label>Dokument:</label>
   <select class="form-control mb-2" [(ngModel)]="dokumentZaUporediId" (change)="ucitajVerzijeZaUporedi()">
    <option *ngFor="let d of dokumenti" [value]="d.id">{{ d.naziv }}</option>
  </select>

    <div *ngIf="verzije.length > 0">
      <p>Izaberi 2 verzije:</p>
      <div *ngFor="let v of verzije" class="form-check">
        <input type="checkbox" class="form-check-input" [checked]="izabraneVerzije.includes(v)" (change)="toggleVerzija(v)" />
        <label class="form-check-label">
          Verzija {{ v.brojVerzije }} - {{ v.datumKreiranja | date:'short' }}
        </label>
      </div>
      <button class="btn btn-outline-dark mt-2" [disabled]="izabraneVerzije.length !== 2" (click)="uporedi()">ğŸ” Uporedi</button>
    </div>

    <div *ngIf="diffHtml" class="mt-4">
      <h4>Rezultat:</h4>
      <div [innerHTML]="diffHtml"></div>
    </div>
  </div>
</div>

  <!-- <div class="d-flex gap-3">
    <button class="btn btn-success" (click)="sacuvajTekstualnuVerziju()">â• Dodaj tekstualnu verziju</button>
    <input type="file" (change)="onFileChange($event)" />
    <button class="btn btn-primary" (click)="uploadVerzija()">ğŸ“¤ Upload verzije</button>
    <button class="btn btn-secondary" (click)="otkazi()">OtkaÅ¾i</button>
  </div>
</div> -->
